########################################
#           DEFINITIONS & MOD KEYS     #
########################################

$mainMod = SUPER
$terminal = kitty
$editor = neovim
$browser = qutebrowser
$launcher = wofi # Define the launcher here for use in submaps

########################################
#          GLOBAL KEYBINDINGS         #
########################################
bind = $mainMod, RETURN, exec, $terminal 
bind = $mainMod, K, killactive
bind = $mainMod, D, exec, $launcher # Global launcher bind
bind = $mainMod, Q, exec, $browser
bind = CTRL+SUPER, R, exec, systemctl reboot
bind = $mainMod, W, hyprexpo:expo, toggle
bind = $mainMod, R, exec, hyprctl reload
bind = $mainMod, Space, fullscreen

# Dwindle Split Preselection (Used by $mainMod + arrows to preselect split)
bind = $mainMod, left, layoutmsg, preselect l
bind = $mainMod, right, layoutmsg, preselect r
bind = $mainMod, up, layoutmsg, preselect u
bind = $mainMod, down, layoutmsg, preselect d

# Pyprland commands
bind = $mainMod, N, exec, pypr toggle_special stash
bind = $mainMod, G, exec, pypr toggle term
bind = $mainMod, Y, exec, pypr attach
bind = $mainMod, Z, exec, pypr zoom
bind = $mainMod, M, pseudo # Toggles Pseudo Tiling mode

workspace = special:exposed,gapsout:60,gapsin:30,bordersize:5,border:true,shadow:false
# Primary Easymotion bind (still useful outside submaps)
bind = SUPER, v, easymotion, action:hyprctl dispatch focuswindow address:{}


########################################
#          SUBMAPS DEFINITION         #
########################################

# Keybind to enter main mode: $mainMod + F or $mainMod + H
bind = $mainMod, f, submap, core_mod
bind = $mainMod, h, submap, core_mod

# --- core_mod Submap (Main Hub) ---
submap = core_mod
    # Dwindle Split/Swap 
    bind = , t, layoutmsg, togglesplit; submap, reset
    bind = , x, layoutmsg, swapsplit; submap, reset
    bind = , p, pseudo, ; submap, reset # Toggle Pseudo-tiling 
    
    # === DWINDLE PRESELECT DIRECTION (ADDED) ===
    # Preselect left
    bind = , h, layoutmsg, preselect l; submap, reset
    bind = , left, layoutmsg, preselect l; submap, reset
    # Preselect right
    bind = , l, layoutmsg, preselect r; submap, reset
    bind = , right, layoutmsg, preselect r; submap, reset
    # Preselect top (using 'k' for up)
    bind = , k, layoutmsg, preselect u; submap, reset
    bind = , up, layoutmsg, preselect u; submap, reset
    # Preselect bottom (using 'j' for down)
    bind = , j, layoutmsg, preselect d; submap, reset
    bind = , down, layoutmsg, preselect d; submap, reset
    # ==========================================
    # Keybind added: Easymotion for quick focus
    # NOTE: 'e' is also used for Easymotion in other submaps
    bind = , e, easymotion, action:hyprctl dispatch focuswindow address:{}
    bind = , RETURN, exec, $terminal 

    # --- ENTER SUBMAPS (Activation Keys) ---
    # NOTE: 'h', 'l', 'k', 'j' are now used for preselect and will not enter another submap
    # If you want to enter a submap, you must use a key not bound above (e.g., 'a', 'f', 'r', etc.)
    bind = , f, submap, focus_mode  # 'f' for Focus movement
    bind = , r, submap, resize_mode # 'r' for Resize window
    bind = , s, submap, swap_mode   # 's' for Swap windows
    bind = , w, submap, workspace_mode # 'w' for Workspaces
    bind = , q, submap, quit_mode   # 'q' for Quit/Power actions

    # Exit core_mod
    bind = , Escape, submap, reset
    bind = , catchall, submap, reset


#
# ----------------------------------------------------
# ACTIVATION KEY: 'f' (from core_mod and others)
# ----------------------------------------------------
# --- focus_mode Submap (Layout Master Focus) ---
submap = focus_mode
    # Focus controls (using H, J, K, L)
    bind = , h, movefocus, l
    bind = , left, movefocus, l
    bind = , l, movefocus, r
    bind = , right, movefocus, r
    bind = , k, movefocus, u
    bind = , up, movefocus, u
    bind = , j, movefocus, d
    bind = , down, movefocus, d
    bind = , Space, fullscreen
    
    # Seamless transitions and Easymotion
    bind = , r, submap, resize_mode
    bind = , s, submap, swap_mode
    bind = , w, submap, workspace_mode
    bind = , q, submap, quit_mode
    bind = , e, easymotion, action:hyprctl dispatch focuswindow address:{}
    bind = , a, submap, launch_mode # Transition to directional launch

    # Exit
    bind = , Escape, submap, reset
    bind = , catchall, submap, reset


# ----------------------------------------------------
# ACTIVATION KEY: 'r' (from core_mod and others)
# ----------------------------------------------------
# --- resize_mode Submap ---
submap = resize_mode
    # Resize controls
    bind = , h, resizeactive, -25 0
    bind = , left, resizeactive, -25 0
    bind = , l, resizeactive, 25 0
    bind = , right, resizeactive, 25 0
    bind = , k, resizeactive, 0 -25
    bind = , up, resizeactive, 0 -25
    bind = , j, resizeactive, 0 25
    bind = , down, resizeactive, 0 25
    
    # Seamless transitions and Easymotion
    bind = , f, submap, focus_mode
    bind = , s, submap, swap_mode
    bind = , w, submap, workspace_mode
    bind = , q, submap, quit_mode
    bind = , e, easymotion, action:hyprctl dispatch focuswindow address:{}
    bind = , a, submap, launch_mode

    # Exit
    bind = , Escape, submap, reset
    bind = , catchall, submap, reset


# ----------------------------------------------------
# ACTIVATION KEY: 's' (from core_mod and others)
# ----------------------------------------------------
# --- swap_mode Submap ---
submap = swap_mode
    # Swap controls
    bind = , h, movewindow, l
    bind = , left, movewindow, l
    bind = , l, movewindow, r
    bind = , right, movewindow, r
    bind = , k, movewindow, u
    bind = , up, movewindow, u
    bind = , j, movewindow, d
    bind = , down, movewindow, d
    
    # Seamless transitions and Easymotion
    bind = , f, submap, focus_mode
    bind = , r, submap, resize_mode
    bind = , w, submap, workspace_mode
    bind = , q, submap, quit_mode
    bind = , e, easymotion, action:hyprctl dispatch focuswindow address:{}
    bind = , a, submap, launch_mode

    # Exit
    bind = , Escape, submap, reset
    bind = , catchall, submap, reset


# ----------------------------------------------------
# ACTIVATION KEY: 'w' (from core_mod and others)
# ----------------------------------------------------
# --- workspace_mode Submap ---
submap = workspace_mode
    # Workspace controls (using numbers 0-9)
    bind = , 1, workspace, 1
    bind = , 2, workspace, 2
    bind = , 3, workspace, 3
    bind = , 4, workspace, 4
    bind = , 5, workspace, 5
    bind = , 6, workspace, 6
    bind = , 7, workspace, 7
    bind = , 8, workspace, 8
    bind = , 9, workspace, 9
    bind = , 0, workspace, 10

    bind = SHIFT, 1, movetoworkspace, 1
    bind = SHIFT, 2, movetoworkspace, 2
    bind = SHIFT, 3, movetoworkspace, 3
    bind = SHIFT, 4, movetoworkspace, 4
    bind = SHIFT, 5, movetoworkspace, 5
    bind = SHIFT, 6, movetoworkspace, 6
    bind = SHIFT, 7, movetoworkspace, 7
    bind = SHIFT, 8, movetoworkspace, 8
    bind = SHIFT, 9, movetoworkspace, 9
    bind = SHIFT, 0, movetoworkspace, 10

    bind = CTRL, 1, movetoworkspace, 1
    bind = CTRL, 2, movetoworkspace, 2
    bind = CTRL, 3, movetoworkspace, 3
    bind = CTRL, 4, movetoworkspace, 4
    bind = CTRL, 5, movetoworkspace, 5
    bind = CTRL, 6, movetoworkspace, 6
    bind = CTRL, 7, movetoworkspace, 7
    bind = CTRL, 8, movetoworkspace, 8
    bind = CTRL, 9, movetoworkspace, 9
    bind = CTRL, 0, movetoworkspace, 10

    # Seamless transitions and Easymotion
    bind = , f, submap, focus_mode
    bind = , r, submap, resize_mode
    bind = , s, submap, swap_mode
    bind = , q, submap, quit_mode
    bind = , e, easymotion, action:hyprctl dispatch focuswindow address:{}
    bind = , a, submap, launch_mode

    # Exit
    bind = , Escape, submap, reset
    bind = , catchall, submap, reset


# ----------------------------------------------------
# ACTIVATION KEY: 'q' (from core_mod and others)
# ----------------------------------------------------
# --- quit_mode Submap ---
submap = quit_mode
    # Quit controls
    bind = , q, exec, hyprctl dispatch exit
    bind = , p, exec, systemctl poweroff
    bind = , r, exec, systemctl reboot
    bind = , s, exec, systemctl suspend
    bind = , l, exec, hyprlock
    
    # Seamless transitions and Easymotion
    bind = , f, submap, focus_mode
    bind = , r, submap, resize_mode
    bind = , s, submap, swap_mode
    bind = , w, submap, workspace_mode
    bind = , e, easymotion, action:hyprctl dispatch focuswindow address:{}
    bind = , a, submap, launch_mode

    # Exit
    bind = , Escape, submap, reset
    bind = , catchall, submap, reset

# --- Submap Reset ---
submap = reset
